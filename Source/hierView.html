<html>
	<style>
			.orgChartLink:link {text-decoration:none;}
			.orgChartLink:visited {text-decoration:none;}
			.orgChartLink:hover {text-decoration:underline;}
			#print {
				width:20;
				height:20;
				align:right;
				border:0;
			}
	</style>
	<head>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script language="javascript">
			
			/* 	debugMode=1 -> Init
				debugMode=2 -> SoapClient
				debugMode=3 -> View Query
				debugMode=4 -> Node Query
				debugMode=5 -> L3 Query Result 
				debugMode=6 -> DD Query Result */

			var debugMode = 0;
			var viewCode = "";
			var urlPortlet = window.document.URL;
			var viewLocation = urlPortlet.indexOf('\&viewID=');
			var debugLocation = urlPortlet.indexOf('\&debugMode=');
			if (viewLocation > debugLocation) {
				if (debugLocation>=0) {
					debugMode = urlPortlet.substring(debugLocation+11,viewLocation);
				} 
				viewCode = urlPortlet.substring(viewLocation+8);
			} else {
				viewCode = urlPortlet.substring(viewLocation+8,debugLocation);
				debugMode = urlPortlet.substring(debugLocation+11);
			}

			var drillPage = "";
			var nodeName = [];
			var nodeId = [];
			var nodeParentName = [];
			var nodeParentId = [];
			var nodeLevel = [];
			var nodeSortOrder = [];
			var nodeSize = [];  
			var nodeColor = []; 
			var nodeColorName = [];
			var nodeFontColorName = [];
			var nodeLinkUrl = [];
			var nodeAdditionalInfo = [];
			var nodeAdditionalInfoHTML = [];
			var sequentialChildArray = [];
			var sequentialParentArray = [];
			var viewAttributes = [];
			var tooltip_font_family = "";
			var tooltip_font_size = 0;
			var tooltip_color = "";
			var tooltip_font_color = "";
			var tooltip_width = 0;
			
			if(debugMode!=0)
				console.log("Executing Main with debugMode="+debugMode);
			google.load('visualization', '1.1', {'packages':['sankey','wordtree','treemap','orgchart']});
			google.setOnLoadCallback(drawMyChart);
			
		function SOAPClient() {}
		SOAPClient.invoke = function(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback)
		{
			if(debugMode==2) 
				console.log("SOAPClient.invoke");
			if(debugMode==2)
					console.log("SOAPClient.invoke sync will loadWsdl");
			return SOAPClient._loadWsdl(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback);
		}

		SOAPClient_cacheWsdl = new Array();

		SOAPClient._loadWsdl = function(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback)
		{
			if(debugMode==2)
				console.log("SOAPClient._loadWsdl");

			var wsdl = SOAPClient_cacheWsdl[url];
			if(wsdl + "" != "" && wsdl + "" != "undefined") {
				if(debugMode==2)
					console.log("SOAPClient._loadWsdl wsdl from cache will sendSoapRequest");
				/*return SOAPClient._sendSoapRequest(debugMode, url, xog_url, method, headparameters, parameters, filter, async, callback, wsdl);*/
				return 0;
			}
			/* get wsdl */
			if(debugMode==2)
				console.log("SOAPClient._loadWsdl will getXmlHttp");
				
			var xmlHttp = SOAPClient._getXmlHttp();
			xmlHttp.open("GET", url + "?wsdl", async);
			xmlHttp.send(null);

			if(debugMode==2) {
				console.log("SOAPClient._loadWsdl sync xmlHttp Status=" + xmlHttp.status);
				console.log("SOAPClient._loadWsdl sync xmlHttp Response=" + xmlHttp.responseText);
			}
			return SOAPClient._onLoadWsdl(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback, xmlHttp);
		}

		SOAPClient._onLoadWsdl = function(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback, req)
		{
			if(debugMode==2)
				console.log("SOAPClient._onLoadWsdl");
			var wsdl = req.responseXML;
			if(debugMode==2)
				console.log("SOAPClient._onloadWsdl will sendSoapRequest");

			SOAPClient_cacheWsdl[url] = wsdl;	/* save a copy in cache */
			return SOAPClient._sendSoapRequest(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback, wsdl);
		}

		SOAPClient._sendSoapRequest = function(url, xog_url, method, headparameters, parameters, filter, sort, sortDir, async, callback, wsdl)
		{
			if(debugMode==2)
				console.log("SOAPClient._sendSoapRequest");
			var ns = (wsdl.documentElement.attributes["targetNamespace"] + "" == "undefined") ? wsdl.documentElement.attributes.getNamedItem("targetNamespace").nodeValue : wsdl.documentElement.attributes["targetNamespace"].value;
			var req_init=String.fromCharCode(60)+'?xml version="1.0" encoding="utf-8"?'+String.fromCharCode(62);
			var req_envelope='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">';
			if(method!="Login")	{
				var req_header='<soap:Header><Auth>' + headparameters.toXml() + '</Auth></soap:Header>';
			} 
			else {
				var req_header ="";
				var req_header_close="";
			}
			var filterTag="";
			var sortTag="";
			
			if((method!="Logout") && (method!="Login")){
				if (filter.toXml().length>0) {
					filterTag = '<Filter>' + filter.toXml()+'</Filter>';
					if(debugMode==2) console.log("filter: " + filterTag);
				}
				if (sort.toXml().length>0) {
					sortTag='<Sort><Column>' + sort.toXml()+ sortDir.toXml()+'</Column></Sort>';
					/* sortTag='<Sort><Column><Name>nodeSortOrder</Name><Direction>Asc</Direction></Column></Sort>';*/
					if(debugMode==2) console.log("sort: " + sortTag);
				}
				var req_body='<soap:Body><' + method + ' xmlns="' + ns + '">' + parameters.toXml() + filterTag + sortTag + '</' + method + '></soap:Body>';
				
/*				if((method!="Login") && (filter.toXml().length>0)
					var req_body='<soap:Body><' + method + ' xmlns="' + ns + '">' + parameters.toXml() +'<Filter>' + filter.toXml()+'</Filter>'+ '</' + method + '></soap:Body>';
				else		
					var req_body='<soap:Body><' + method + ' xmlns="' + ns + '">' + parameters.toXml() + '</' + method + '></soap:Body>';*/
			}
			else {
				var req_body='<soap:Body><Logout/></soap:Body>';
			}
			var req_envelope_close='</soap:Envelope>';
			var sr = req_init+req_envelope+req_header+req_body+req_envelope_close;
			if(debugMode==2)
				console.log("SOAPClient._sendSoapRequest sr="+sr);
			var xmlHttp = SOAPClient._getXmlHttp();
			xmlHttp.open("POST", xog_url, async);
			var soapaction = ((ns.lastIndexOf("/") != ns.length - 1) ? ns + "/" : ns) + method;
			xmlHttp.setRequestHeader("SOAPAction", soapaction);
			xmlHttp.setRequestHeader("Content-Type", "text/xml; charset=utf-8");
			xmlHttp.send(sr);
			if(debugMode==2) {
				console.log("SOAPClient._sendSoapRequest sync xmlHttp Status=" + xmlHttp.status);
				console.log("SOAPClient._sendSoapRequest sync xmlHttp Response=" + xmlHttp.responseText);
			}
				
			return SOAPClient._onSendSoapRequest(method, async, callback, wsdl, xmlHttp);
			
		}

		SOAPClient._onSendSoapRequest = function(method, async, callback, wsdl, req) {
			if(debugMode==2)
				console.log("SOAPClient._onSendSoapRequest");
			var o = null;
			if(method=='Login')
				var nd = SOAPClient._getElementsByTagName(req.responseXML, "SessionID");
			else
				if(method=='Query')
					var nd = SOAPClient._getElementsByTagName(req.responseXML, method + "Result");
				else
					var nd = "";

			if(nd.length == 0) {
				if(debugMode==2)
					console.log("SOAPClient._onSendSoapRequest  ND legth Zero");
				if(req.responseXML.getElementsByTagName("faultcode").length > 0)
					throw new Error(500, req.responseXML.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue);
			}
			else {
				if(debugMode==2)
					console.log("SOAPClient._onSendSoapRequest  Method/ND[0]="+method+" "+nd[0]);
				o=SOAPClient._soapresult2objectv2(method, req, nd[0],wsdl);
			}

			if(callback) {
				callback(o, req.responseXML);
			}

			if(debugMode==2)
				console.log("SOAPClient._onSendSoapRequest Going Back o="+o);
			
			return o;		
		}

		SOAPClient._getElementsByTagName = function(document, tagName) {
			try	{
				/* trying to get node omitting any namespaces (latest versions of MSXML.XMLDocument) */
				return document.selectNodes('.//*[local-name()="'+ tagName +'"]');
			}
			catch (ex) {}
			/* old XML parser support */
			return document.getElementsByTagName(tagName);
		}

		SOAPClient._soapresult2objectv2 = function(method, XMLResponse, node, wsdl) {

			if(method=='Query') {
				return XMLResponse;
			}
			else {
				return SOAPClient._soapresult2object(node, wsdl);
			}
		}

		SOAPClient._soapresult2object = function(node, wsdl) {
			return SOAPClient._node2object(node, wsdl);
		}

		SOAPClient._node2object = function(node, wsdl) {
			if(debugMode==2)
				console.log("SOAPClient._node2object  Node="+node+" Type="+node.nodeType+" ChildNodesLeng="+node.childNodes.length);
			if(node == null)
				return null;
			if(node.nodeType == 3 || node.nodeType == 4) {	
				return SOAPClient._extractValue(node, wsdl);
			}
			if (node.childNodes.length == 1 && (node.childNodes[0].nodeType == 3 || node.childNodes[0].nodeType == 4)) {
				if(debugMode==2)
					console.log("SOAPClient._node2object Leaf="+ node.childNodes[0]);
				return SOAPClient._node2object(node.childNodes[0], wsdl);
			}
			var isarray = SOAPClient._getTypeFromWsdl(node.nodeName, wsdl).toLowerCase().indexOf("arrayof") != -1;
			if(!isarray) {
				var obj = null;
				if(node.hasChildNodes())
					obj = new Object();
				for(var i = 0; i < node.childNodes.length; i++)	{
					var p = SOAPClient._node2object(node.childNodes[i], wsdl);
					obj[node.childNodes[i].nodeName] = p;
				}
				return obj;
			}
			else {
				var l = new Array();
				for(var i = 0; i < node.childNodes.length; i++)
					l[l.length] = SOAPClient._node2object(node.childNodes[i], wsdl);
				return l;
			}
			return null;
		}

		SOAPClient._extractValue = function(node, wsdl) {
			if(debugMode==2) {
				console.log("SOAPClient._extractValue NodeValue="+node.nodeValue);
				console.log("SOAPClient._extractValue NodeParent="+node.parentNode.nodeName);
				console.log("SOAPClient._extractValue getType="+SOAPClient._getTypeFromWsdl(debugMode, node.parentNode.nodeName, wsdl).toLowerCase());
			}
			
			var value = node.nodeValue;
			switch(SOAPClient._getTypeFromWsdl(node.parentNode.nodeName, wsdl).toLowerCase()) {
				default:
				case "s:string":			
					return (value != null) ? value + "" : "";
				case "s:boolean":
					return value+"" == "true";
				case "s:int":
				case "s:long":
					return (value != null) ? parseInt(value + "", 10) : 0;
				case "s:double":
					return (value != null) ? parseFloat(value + "") : 0;
				case "s:datetime":
					if(value == null)
						return null;
					else {
						value = value + "";
						value = value.substring(0, value.lastIndexOf("."));
						value = value.replace(/T/gi," ");
						value = value.replace(/-/gi,"/");
						var d = new Date();
						d.setTime(Date.parse(value));										
						return d;				
					}
			}
		}

		SOAPClient._getTypeFromWsdl = function(elementname, wsdl) {
			if(debugMode==2)
				console.log("SOAPClient._getTypeFromWsdl ElementName="+elementname);
			var ell = wsdl.getElementsByTagName("s:element");	/* IE */
			
			if(debugMode==2)
				console.log("SOAPClient._getTypeFromWsdl  Ell len="+ell.length);
			if(ell.length == 0)	{
				ell = wsdl.getElementsByTagName("element");	/* MOZ */
				if(debugMode==2)
					console.log("SOAPClient._getTypeFromWsdl ELL="+ell+" ell len="+ell.length);
			}
			for(var i = 0; i < ell.length; i++)	{
				if(ell[i].attributes["name"] + "" == "undefined") {
					if(debugMode==2)
						console.log("SOAPClient._getTypeFromWsdl name="+ell[i].attributes.getNamedItem("name")+" nodevalue="+ell[i].attributes.getNamedItem("name").nodeValue + " type="+ell[i].attributes.getNamedItem("type"));
					if(ell[i].attributes.getNamedItem("name") != null && ell[i].attributes.getNamedItem("name").nodeValue == elementname && ell[i].attributes.getNamedItem("type") != null) 
						return ell[i].attributes.getNamedItem("type").nodeValue;
				}	
				else {
					if(ell[i].attributes["name"] != null && ell[i].attributes["name"].value == elementname && ell[i].attributes["type"] != null)
						return ell[i].attributes["type"].value;
				}
			}
			return "";
		}


		SOAPClient._getXmlHttp = function() {
			try	{
				if(window.XMLHttpRequest) {
					var req = new XMLHttpRequest();
					/* some versions of Moz do not support the readyState property and the onreadystate event so we patch it! */
					if(req.readyState == null) {
						req.readyState = 1;
						req.addEventListener("load", 
											function() {
												req.readyState = 4;
												if(typeof req.onreadystatechange == "function")
													req.onreadystatechange();
											},
											false);
					}
					return req;
				}
				if(window.ActiveXObject) {
					return new ActiveXObject(SOAPClient._getXmlHttpProgID());
				}
			}
			catch (ex) {}
			throw new Error("Your browser does not support XmlHttp objects");
		}

		SOAPClient._getXmlHttpProgID = function() {
			if(SOAPClient._getXmlHttpProgID.progid) {
				return SOAPClient._getXmlHttpProgID.progid;
			}
			var progids = ["Msxml2.XMLHTTP.5.0", "Msxml2.XMLHTTP.4.0", "MSXML2.XMLHTTP.3.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"];
			var o;
			for(var i = 0; i < progids.length; i++)	{
				try {
					o = new ActiveXObject(progids[i]);
					return SOAPClient._getXmlHttpProgID.progid = progids[i];
				}
				catch (ex) {};
			}
			throw new Error("Could not find an installed XML parser");
		}

		function ExecuteClarityQueryAsUser(ServerName, QueryCode, QueryFilterField, QueryFilterValue, QuerySortField, QuerySortDir, QueryCallback)	{
			if(debugMode>1) console.log("IN: ExecuteClarityQueryAsUser");
			var url = "http://" + ServerName + "/niku/wsdl/Query/" + QueryCode;
			var xog_url = "http://" + ServerName + "/niku/xog";

			/* Get User's SessionID from Cookie */
			UserSessionID=getCookie('sessionId');
			
			if(debugMode==1) {
				console.log("ExecuteClarityQueryAsUser: URL="+url+" XOG_URL="+xog_url);
				console.log("ExecuteClarityQueryAsUser: UserSessionID="+UserSessionID);
			}

			/* Add SessionID and QueryCode to SOAPClientParameters */
			if(debugMode==2) console.log("ExecuteClarityQueryAsUser: SOAPClientParameters");
			var pheader = new SOAPClientParameters();
			var pbody = new SOAPClientParameters();
			var pbodyfilter = new SOAPClientParameters();
			var pbodysort = new SOAPClientParameters();
			var pbodysortDir = new SOAPClientParameters();
			pheader.add("SessionID", UserSessionID);
			pbody.add("Code", QueryCode);
			if (QueryFilterField!="")
				pbodyfilter.add(QueryFilterField, QueryFilterValue);
			if (QuerySortField!="")
				pbodysort.add("Name", QuerySortField);
			if (QuerySortDir!="")
				pbodysortDir.add("Direction",QuerySortDir);
			
			/* Invokes SOAPClient to Run Query with current User's Session */
			if(debugMode==2) console.log("ExecuteClarityQueryAsUser: SOAPClient.invoke");
			Result=SOAPClient.invoke(url, xog_url, "Query", pheader, pbody, pbodyfilter, pbodysort, pbodysortDir, false, QueryCallback);

			if(debugMode==2) console.log("ExecuteClarityQueryAsUser Response="+Result.responseText);
			if(debugMode>1) console.log("OUT: ExecuteClarityQueryAsUser");
			return Result;
		}

		function SOAPClientParameters() {
			var _pl = new Array();
			this.add = function(name, value) {
				_pl[name] = value; 
				return this; 
			}
			this.toXml = function() {
				var xml = "";
				for(var p in _pl) {
					if(typeof(_pl[p]) != "function")
						xml += "<" + p + ">" + _pl[p].toString().replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">") + "</" + p + ">";
				}
				return xml;	
			}
		}

		function crossBrowserXMLLoad(text) {
			var xmlDoc;
			try {
				xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
				xmlDoc.async="false";
				xmlDoc.loadXML(text);
			}    
			catch(e) {
				try {
					parser=new DOMParser();
					xmlDoc=parser.parseFromString(text,"text/xml");
				}
				catch(e) {
					alert(e.message);
				}
			}
			return xmlDoc;
		}

		function getCookie(cname) {
			var name = cname + "=";
			var ca = document.cookie.split(';');
			for(var i=0; i<ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0)==' ') c = c.substring(1);
				if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
			}
			return "";
		}

			function eventFire(el, etype){
				if (el.fireEvent) {
					el.fireEvent('on' + etype);
				} else {
					var evObj = document.createEvent('Events');
					evObj.initEvent(etype, true, false);
					el.dispatchEvent(evObj);
				}
			}

			function fetchInternalId() {
				if(debugMode==1) console.log("IN: fetchInternalId");				
				/* Fetching View ID 
				var urlPortlet = window.document.URL;
				var idViewLocation = urlPortlet.indexOf('&viewID=')+8;
				var idView = urlPortlet.substring(idViewLocation);
				if(debugMode==1) console.log("portletURL: "+urlPortlet+" idView: "+idView);*/

				/* Fetching ServerName and Item ID */
				var vModal=0;
				var url = this.parent.document.URL;
				if(debugMode==1) console.log("fetchInternalId: URL:"+this.parent.document.URL);
				
				var vDialogs = document.getElementsByClassName("ppm_dialog");
				if (vDialogs.length > 0) vModal=1;
				
				if (vModal==1) {
					/* Popup */
					var innerUrl = document.getElementById('ppm_mnp').innerHTML; /* This is the Div that contains the Modal page */
					idLocation = innerUrl.indexOf('instance_id')+12;
					var end = idLocation + 7;
					var internalID = innerUrl.substring(idLocation,end);
				}
				else
				{
					/* Not a Popup */
					var idLocation = url.indexOf('\&id=')+4;
					var end = idLocation + 7;
					var internalID = url.substring(idLocation, end);
				}
				
				var ServerName = url.substring(7,url.indexOf("niku/")-1);
				if(debugMode==1) console.log("URL: "+url+" Servername: "+ServerName);
				if(debugMode==1) console.log("OUT: fetchInternalId");				
				return [internalID, ServerName];
			}

			function getNodeValue(docNode) {
				if (debugMode==3) console.log("IN: getNodeValue "+docNode);
				if (debugMode==3) console.log("IN: getNodeValue "+docNode.nodeName);
				if (docNode.hasChildNodes()) {
					var returnValue = docNode.firstChild.nodeValue;
				} else {
					var returnValue = 0;
				}

				if (debugMode==3) console.log("OUT: getNodeValue");
				return returnValue;
			}
			
			function loadViewData(Result, viewAttributes) {

				if(debugMode==3) console.log("IN: loadViewData");				
				var xmlobject = crossBrowserXMLLoad(Result.responseText);
				var items = xmlobject.getElementsByTagName("Record");
				if(debugMode==3) console.log("loadViewData: #items " + items.length);				
				
				if (items.length<1) console.log("ERROR: Bad viewID on Portlet src URL");
								
				var item = items[0];
				
				viewAttributes[0] = getNodeValue(item.getElementsByTagName("intlid")[0]);
				viewAttributes[1] = getNodeValue(item.getElementsByTagName("code")[0]);
				viewAttributes[2] = getNodeValue(item.getElementsByTagName("name")[0]);
				viewAttributes[3] = getNodeValue(item.getElementsByTagName("max_depth")[0]);
				viewAttributes[4] = getNodeValue(item.getElementsByTagName("font_family")[0]);
				viewAttributes[5] = getNodeValue(item.getElementsByTagName("font_size")[0]);
				viewAttributes[6] = getNodeValue(item.getElementsByTagName("title_font_size")[0]);
				viewAttributes[7] = getNodeValue(item.getElementsByTagName("min_color")[0]);
				viewAttributes[8] = getNodeValue(item.getElementsByTagName("mid_color")[0]);
				viewAttributes[9] = getNodeValue(item.getElementsByTagName("max_color")[0]);
				viewAttributes[10] = getNodeValue(item.getElementsByTagName("no_color")[0]);
				viewAttributes[11] = getNodeValue(item.getElementsByTagName("header_height")[0]);
				viewAttributes[12] = getNodeValue(item.getElementsByTagName("font_color")[0]);
				viewAttributes[13] = getNodeValue(item.getElementsByTagName("title_font_color")[0]);
				viewAttributes[14] = getNodeValue(item.getElementsByTagName("max_post_depth")[0]);
				viewAttributes[15] = getNodeValue(item.getElementsByTagName("show_scale")[0]);
				viewAttributes[16] = getNodeValue(item.getElementsByTagName("weighted_average")[0]);
				viewAttributes[17] = getNodeValue(item.getElementsByTagName("header_color")[0]);
				viewAttributes[18] = getNodeValue(item.getElementsByTagName("hint_opacity")[0]);
				viewAttributes[19] = getNodeValue(item.getElementsByTagName("min_high_color")[0]);
				viewAttributes[20] = getNodeValue(item.getElementsByTagName("mid_high_color")[0]);
				viewAttributes[21] = getNodeValue(item.getElementsByTagName("max_high_color")[0]);
				viewAttributes[22] = getNodeValue(item.getElementsByTagName("no_high_color")[0]);
				viewAttributes[23] = getNodeValue(item.getElementsByTagName("header_high_color")[0]);
				viewAttributes[24] = getNodeValue(item.getElementsByTagName("min_color_value")[0]);
				viewAttributes[25] = getNodeValue(item.getElementsByTagName("max_color_value")[0]);
				viewAttributes[26] = getNodeValue(item.getElementsByTagName("hiev_chart_node_size")[0]);
				viewAttributes[27] = getNodeValue(item.getElementsByTagName("word_tree_type")[0]);
				viewAttributes[28] = getNodeValue(item.getElementsByTagName("label_padding")[0]);
				viewAttributes[29] = getNodeValue(item.getElementsByTagName("node_padding")[0]);
				viewAttributes[30] = getNodeValue(item.getElementsByTagName("node_width")[0]);
				viewAttributes[31] = getNodeValue(item.getElementsByTagName("sankey_iterations")[0]);
				viewAttributes[32] = getNodeValue(item.getElementsByTagName("link_fill_color")[0]);
				viewAttributes[33] = getNodeValue(item.getElementsByTagName("link_fill_opacity")[0]);
				viewAttributes[34] = getNodeValue(item.getElementsByTagName("link_stroke_color")[0]);
				viewAttributes[35] = getNodeValue(item.getElementsByTagName("link_stroke_width")[0]);
				viewAttributes[36] = getNodeValue(item.getElementsByTagName("node_color")[0]);
				viewAttributes[37] = getNodeValue(item.getElementsByTagName("hierarchy_type")[0]).substring(0,7); 
				viewAttributes[38] = getNodeValue(item.getElementsByTagName("studio_query_id")[0]); 
				drill_new_page = getNodeValue(item.getElementsByTagName("drill_new_page")[0]); 
				if ( drill_new_page == 1 ) {
					viewAttributes[39] = "_blank";
				} else {
					viewAttributes[39] = "_parent";
				}
				viewAttributes[40] = getNodeValue(item.getElementsByTagName("tooltip_font_family")[0]);
				viewAttributes[41] = getNodeValue(item.getElementsByTagName("tooltip_font_size")[0]);
				viewAttributes[42] = getNodeValue(item.getElementsByTagName("tooltip_color")[0]);
				viewAttributes[43] = getNodeValue(item.getElementsByTagName("tooltip_font_color")[0]);
				viewAttributes[44] = getNodeValue(item.getElementsByTagName("tooltip_width")[0]);
				viewAttributes[45] = getNodeValue(item.getElementsByTagName("portlet_width")[0]);
				viewAttributes[46] = getNodeValue(item.getElementsByTagName("portlet_height")[0]);
				
				if(debugMode==3) console.log("loadViewData: id " + viewAttributes[0] + " code " + viewAttributes[1] + " name " + viewAttributes[2] + " query " + viewAttributes[38]);				
				if(debugMode==3) console.log("OUT: loadViewData");				

				return viewAttributes[0];
			}

			function loadNodeData(Result, nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML) {
				if(debugMode==4) console.log("IN: loadNodeData");	
				var xmlobject = crossBrowserXMLLoad(Result.responseText);
				var items = xmlobject.getElementsByTagName("Record");
				if(debugMode==4) console.log("loadNodeData: #items " + items.length);				
				for (var i = 0 ; i < items.length ; i++) {
					var item = items[i];
					nodeId[i] = getNodeValue(item.getElementsByTagName("nodeid")[0]);
					nodeName[i] = getNodeValue(item.getElementsByTagName("nodename")[0]);
					nodeParentId[i] = getNodeValue(item.getElementsByTagName("nodeparentid")[0]);
					nodeParentName[i] = getNodeValue(item.getElementsByTagName("nodeparentname")[0]);
					nodeLevel[i] = getNodeValue(item.getElementsByTagName("nodelevel")[0]);
					nodeSortOrder[i] = getNodeValue(item.getElementsByTagName("nodesortorder")[0]);
					var nodeSizeStr = getNodeValue(item.getElementsByTagName("nodesize")[0]);
					var nodeColorStr = getNodeValue(item.getElementsByTagName("nodecolor")[0]);
					nodeColorName[i] = getNodeValue(item.getElementsByTagName("nodecolorname")[0]);
					nodeFontColorName[i] = getNodeValue(item.getElementsByTagName("nodefontcolorname")[0]);
					nodeLinkUrl[i] = getNodeValue(item.getElementsByTagName("nodelinkurl")[0]);
					nodeAdditionalInfo[i] = getNodeValue(item.getElementsByTagName("nodeadditionalinfo")[0]);
					nodeAdditionalInfoHTML[i] = getNodeValue(item.getElementsByTagName("nodeadditionalinfohtml")[0]);
					
					if (typeof nodeName[i] !== 'undefined') {
						if ( typeof nodeSizeStr !== 'undefined' && typeof nodeColorStr !== 'undefined' ) {
								nodeSize[i] = Number( nodeSizeStr );
								nodeColor[i] = Number( nodeColorStr );
								if (typeof nodeSize[i] == 'undefined') {
									if(debugMode==4) console.log("loadNodeData: i " + i + " nodeId " + nodeId[i] + " nodeName " + nodeName[i] + " bad Number in Size " + nodeSizeStr);
									nodeSize[i] = 0.00;	
								}
								if (typeof nodeColor[i] == 'undefined') {
									if(debugMode==4) console.log("loadNodeData: i " + i + " nodeId " + nodeId[i] + " nodeName " + nodeName[i] + " bad Number in Color " + nodeColorStr);
									nodeColor[i] = 0;
								}
						} else {
							if(debugMode==4) console.log("loadNodeData: i " + i + " nodeId " + nodeId[i] + " nodeName " + nodeName[i] + " undefined StrSize or StrColor ");
							nodeSize[i] = 0.00;
							nodeColor[i] = 0.00;
						}
						
						if(debugMode==4) console.log("loadNodeData: i "+ i + " nodeId " + nodeId[i] + " nodeName " + nodeName[i] + " nodeParentName " + nodeParentName[i]+ " nodeParentId " + nodeParentId[i]);
						if(debugMode==4) console.log("loadNodeData: i "+ i + " --nodeLevel " + nodeLevel[i] + " nodeSizeStr " + nodeSizeStr + " nodeSize " + nodeSize[i]+ " nodeColorStr " + nodeColorStr+ " nodeColor " + nodeColor[i]);
						if(debugMode==4) console.log("loadNodeData: i "+ i + " --nodeColorName " + nodeColorName[i] + " nodeLinkUrl " + nodeLinkUrl + " nodeAdditionalInfo " + nodeAdditionalInfo[i]);
					} else {
						if(debugMode==4) console.log("loadNodeData: i " + i + " nodeId " + nodeId[i] + " nodeName undefined");
					}
				}
				
				if(debugMode==4) console.log("OUT: loadNodeData");				
				return items.length;
			}
			
			function swapArray (anArray, anIndex) {
				var temp = anArray[anIndex];
				anArray[anIndex] = anArray[anIndex+1];
				anArray[anIndex+1] = temp;
				return anArray;
			}

			function bubbleSort(nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML)
			{
				var swapped;
				do {
					swapped = false;
					for (var i=0; i < nodeSortOrder.length-1; i++) {
						if (Number(nodeSortOrder[i]) > Number(nodeSortOrder[i+1])) {
							nodeId = swapArray(nodeId, i);
							nodeName = swapArray(nodeName, i);
							nodeParentId = swapArray(nodeParentId, i);
							nodeParentName = swapArray(nodeParentName, i);
							nodeLevel = swapArray(nodeLevel, i);
							nodeSortOrder = swapArray(nodeSortOrder, i);
							nodeSize = swapArray(nodeSize, i);
							nodeColor = swapArray(nodeColor, i);
							nodeColorName = swapArray(nodeColorName, i);
							nodeFontColorName = swapArray(nodeFontColorName, i);
							nodeLinkUrl = swapArray(nodeLinkUrl, i);
							nodeAdditionalInfo = swapArray(nodeAdditionalInfo, i);
							nodeAdditionalInfoHTML = swapArray(nodeAdditionalInfoHTML, i);
							swapped = true;
						}
					}
				} while (swapped);
			}
 
			function showTreeMapTooltip(row, size, value)
			{
			
				var addlInfo = nodeAdditionalInfoHTML[row];
				var itemLink = nodeLinkUrl[row];
				var tooltipNode = nodeName[row];
				
				return '<div style="width:' + tooltip_width + '; background-color:' + tooltip_color + '; position: absolute; z-index: 100; padding:10px; border-style:none;">' +
						'<span style="font-family:' + tooltip_font_family + '; font-size:'+ tooltip_font_size + 'px; color:' + tooltip_font_color + '">' + addlInfo +
						'<br>' + '<a target="' + drillPage + '" href="' + itemLink + '">' + tooltipNode + '</a><br></span></div>';
			}

			function addSequentialId(childId, parentId)
			{
				var idFound = false;
				for (var x=0; x<sequentialChildArray.length; x++) {
					if ((sequentialChildArray[x] == childId) 
						&& (sequentialParentArray[x] == parentId)) {
						if (debugMode > 2) console.log("Node " + childId + " for parent " + parentId + " found at position " + x + ". Not ADDED");
						idFound = true;
					}
				}
				if (idFound == false) {
					if (debugMode > 2) console.log("Node " + childId + " for parent " + parentId + " not found. Adding at position " + x);
					sequentialChildArray.push([childId]);
					sequentialParentArray.push([parentId]);
				}
			}

			function findId(childId, parentId)
            		{
				for (var x = 0; x<sequentialChildArray.length; x++)
		                {
					if (((sequentialChildArray[x] == childId) && (sequentialParentArray[x] == parentId)) ||
					    ((sequentialChildArray[x] == childId) && (parentId == -1)))
                    			{
						return x;
                    			}
                		}
                		return -1;
			}

			function drawMyChart() {

			if(debugMode==1) console.log("IN: drawMyChart");
				
				var Server=fetchInternalId();
				var internalID=Server[0];
				var ServerName=Server[1];
				if(debugMode==1) console.log("drawMyChart: ServerName: "+ServerName);
				var Result;
				var viewId;
				var totalitems;
				var QueryFilterField;
				var QueryFilterValue;
				var QueryCallback;
				var QueryCode;
				var QuerySortField='';
				var QuerySortDir='';

				var itemNameLong="";
				var linkClass="";

				/* Execute Query to list Hierarchical Views
					use this statement to test running the query as admin (remember to set the password accordingly)
					var Result=ExecuteClarityQueryAsAdmin(debugMode, ServerName, QueryCode, QueryFilterField, QueryFilterValue, "admin", "iluvca", QueryCallback);
				*/
				QueryFilterField = "code";
				QueryFilterValue = viewCode;
				QueryCallback="";
				QueryCode="hiev_list_wsdl";
				if(debugMode==3) console.log("drawMyChart: View List --Server Name: "+ServerName+"--Query Code: "+QueryCode+"--Filter Field: "+QueryFilterField+"--Filter Value: "+QueryFilterValue+"--Call Back: "+QueryCallback);
				Result=ExecuteClarityQueryAsUser(ServerName, QueryCode, QueryFilterField, QueryFilterValue, QuerySortField, QuerySortDir, QueryCallback);
				
				if(debugMode==3) console.log("drawMyChart: Back from View List:"+Result.responseText);
				viewId=loadViewData(Result, viewAttributes);
				if(debugMode==3) console.log("drawMyChart: Back from View Data: "+viewId);

				var id = viewAttributes[0];
				var code = viewAttributes[1]; 	
				var name = viewAttributes[2]; 
				var max_depth = viewAttributes[3]; 
				var font_family = viewAttributes[4]; 
				var font_size = viewAttributes[5]; 
				var title_font_size = viewAttributes[6]; 
				var min_color = viewAttributes[7]; 
				var mid_color = viewAttributes[8]; 
				var max_color = viewAttributes[9]; 
				var no_color = viewAttributes[10]; 
				var header_height = viewAttributes[11]; 
				var font_color = viewAttributes[12]; 
				var title_font_color = viewAttributes[13]; 
				var max_post_depth = viewAttributes[14]; 
				var show_scale = viewAttributes[15]; 
				var weighted_average = viewAttributes[16]; 
				var header_color = viewAttributes[17]; 
				var hint_opacity = viewAttributes[18]; 
				var min_high_color = viewAttributes[19]; 
				var mid_high_color = viewAttributes[20]; 
				var max_high_color = viewAttributes[21]; 
				var no_high_color = viewAttributes[22]; 
				var header_high_color = viewAttributes[23]; 
				var min_color_value = viewAttributes[24]; 
				var max_color_value = viewAttributes[25]; 
				var chart_node_size = viewAttributes[26]; 
				var word_tree_type = viewAttributes[27]; 
				var label_padding = viewAttributes[28]; 
				var node_padding = viewAttributes[29]; 
				var node_width = viewAttributes[30]; 
				var sankey_iterations = viewAttributes[31]; 
				var link_fill_color = viewAttributes[32]; 
				var link_fill_opacity = viewAttributes[33]; 
				var link_stroke_color = viewAttributes[34]; 
				var link_stroke_width = viewAttributes[35]; 
				var node_color = viewAttributes[36]; 
				var hier_type = viewAttributes[37]; 
				var studio_query_id = viewAttributes[38];
				drillPage = viewAttributes[39]; 
				tooltip_font_family = viewAttributes[40];
				tooltip_font_size = viewAttributes[41];
				tooltip_color = viewAttributes[42];
				tooltip_font_color = viewAttributes[43];
				tooltip_width = viewAttributes[44];
				var portlet_width = viewAttributes[45];
				var portlet_height = viewAttributes[46];

				if(debugMode==3) console.log("drawMyChart: Reading Attributes hier_type "+hier_type + " and drill page "+drillPage);
				
				/* Execute Query to list Nodes
					use this statement to test running the query as admin (remember to set the password accordingly)
					var Result=ExecuteClarityQueryAsAdmin(debugMode, ServerName, QueryCode, QueryFilterField, QueryFilterValue, "admin", "iluvca", QueryCallback);
				*/
				QueryFilterField = "param_intlid";
				QueryFilterValue = internalID;
				QueryCallback="";
				QueryCode=studio_query_id;
				QuerySortField='nodeSortOrder';
				QuerySortDir='Asc';
				if(debugMode==4) console.log("drawMyChart: Node List --Server Name: "+ServerName+"--Query Code: "+QueryCode+"--Filter Field: "+QueryFilterField+"--Filter Value: "+QueryFilterValue+"--Call Back: "+QueryCallback);
				Result=ExecuteClarityQueryAsUser(ServerName, QueryCode, QueryFilterField, QueryFilterValue, QuerySortField, QuerySortDir, QueryCallback);
				
				if(debugMode==4) console.log("drawMyChart: Back from Node List:"+Result.responseText);
				totalitems=loadNodeData(Result, nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML);
				if(debugMode==4) console.log("drawMyChart: Back from Node Data: "+totalitems + " node0 " + nodeId[0] + " lastNode " + nodeId[totalitems-1]);
				
				switch (hier_type) {
					case "TreeMap":
						if (debugMode > 1) console.log("Creating Tree Map DataTable");
						/*bubbleSort(nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML);*/
						var data = new google.visualization.DataTable();
						if (debugMode > 1) console.log("Creating Tree Map DataTable2");
						data.addColumn('string', 'nodeName');
						data.addColumn('string', 'nodeParent');
						data.addColumn('number', 'nodeSize');
						data.addColumn('number', 'nodeColor');

						if (totalitems > 0)	data.addRow([nodeName[0], '', nodeSize[0], nodeColor[0]]);
						for (var i = 1 ; i < totalitems ; i++) {
							data.addRow([nodeName[i], nodeParentName[i], nodeSize[i], nodeColor[i]]);
						}
					
						if (debugMode > 1) console.log("dataTable is Ready");
					
						tree = new google.visualization.TreeMap(document.getElementById('map_canvas'));
						if (debugMode > 1) console.log("drawTreeHeatMap");
						tree.draw(data, 
						{
							width: portlet_width, height: portlet_height,
							maxDepth: max_depth,
							fontFamily: font_family,
							fontSize: font_size,
							fontColor: font_color,
							minColor: min_color,
							midColor: mid_color,
							maxColor: max_color,
							noColor:  no_color,
							headerHeight: header_height,
							showScale: show_scale,
							maxPostDepth: max_post_depth,
							useWeightedAverageForAggregation: weighted_average,
							headerColor: header_color, 
							hintOpacity: hint_opacity,
							headerHighlightColor: header_high_color,
							minHighlightColor: min_high_color,
							midHighlightColor: mid_high_color,
							maxHighlightColor: max_high_color,
							noHighlightColor: no_high_color,
							minColorValue: min_color_value,
							maxColorValue: max_color_value,
							generateTooltip: showTreeMapTooltip,
							title: name,
							titleTextStyle: 
										{
											color: title_font_color,
											fontName: font_family,
											fontSize: title_font_size,
											bold: true,
											italic: false
										}
						});

						break;
					case "WordTre":
						if (debugMode > 1) console.log("Creating WordTree DataTable");
						/*bubbleSort(nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML);*/
						
						var data = new google.visualization.DataTable();
						data.addColumn('number', 'id');
						data.addColumn('string', 'childLabel');
						data.addColumn('number', 'parent');
						data.addColumn('number', 'weight');
						data.addColumn('string', 'color');

						var childId = -1;
						var childLabel = "";
						var sizeWord = 0;
						var colorWord = "";
						var parent = -1;
						if (debugMode > 2) console.log("Creating Sequential ID Array");
						
						for (ind = 0; ind < totalitems; ind++){
							if (debugMode > 2) console.log("Index: " + ind + " is Node " + nodeId[ind]);
							addSequentialId(nodeId[ind], nodeParentId[ind]);
						}

						for (ind = 0; ind < totalitems; ind++)
						{
							childId = findId(nodeId[ind], nodeParentId[ind]);
							if (debugMode > 2) console.log("Index: "+ ind + " - Child " + nodeId[ind] + " found Id " + childId);

							if (ind==0)
							{
								parent = -1;
							}
							else
							{
								parent = findId(nodeParentId[ind],-1);
							}
							if (debugMode > 3) console.log("Parent " + nodeParentId[ind] + " has Id " + parent);
							if (debugMode > 2) console.log("Will Add Row to Data Array: " + childId + ", " + nodeName[ind] + ", " + parent + ", " + nodeColorName[ind]);
							data.addRow([childId, nodeName[ind], parent, 1, nodeColorName[ind]]);
						}
			
						if (debugMode > 1) console.log("dataTable is Ready");

						tree = new google.visualization.WordTree(document.getElementById('map_canvas'));
						if (debugMode > 1) console.log("drawWordTree "+font_family+font_size);
						
						tree.draw(data, 
						{ 
							width: portlet_width, height: portlet_height,
							maxFontSize: font_size, 
							fontName: font_family, 
							wordtree: 
							{ 
								format: 'explicit', 
								type: word_tree_type
							}
						});
						
						break;
					case "OrgChar":
						if (debugMode > 1) console.log("Creating Org Chart DataTable");
						/* bubbleSort(nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML);*/
						var data = new google.visualization.DataTable();
						if (debugMode > 1) console.log("Creating Org Chart DataTable2");
						data.addColumn('string', 'nodeName');
						data.addColumn('string', 'nodeParent');
						data.addColumn('string', 'nodeTooltip');
						
						nodeParentName[0]="";
						for (var i = 0 ; i < totalitems ; i++) {
							itemNameLong = '<div style="background-color: ';
							itemNameLong += nodeColorName[i];
							itemNameLong += '; padding:10px; font-family:' + font_family;
							itemNameLong += '; font-size:' + font_size;
							itemNameLong += '"><a class="orgChartLink" style="color:'+ nodeFontColorName[i];
							itemNameLong += '" target="' + drillPage + '" href="' + nodeLinkUrl[i] + '">' + nodeName[i] + '</a></div>';
							
							linkInfo = '<b><a target="' + drillPage + '" href="' + nodeLinkUrl[i] + '">' + nodeName[i] + '</a></b>';
							data.addRow([{v:nodeName[i], f:itemNameLong}, nodeParentName[i], nodeAdditionalInfo[i]]);
						}

						if (debugMode > 1) console.log("dataTable is Ready");

						tree = new google.visualization.OrgChart(document.getElementById('map_canvas'));
						if (debugMode > 1) console.log("drawOrgChart");

						tree.draw(data, {allowHtml:true, allowCollapse:true, size:chart_node_size});
						break;
					case "SankeyD":
						if (debugMode > 1) console.log("Create Sankey Diagram DataTable");
						/* bubbleSort(nodeId, nodeName, nodeParentId, nodeParentName, nodeLevel, nodeSortOrder, nodeSize, nodeColor, nodeColorName, nodeFontColorName, nodeLinkUrl, nodeAdditionalInfo, nodeAdditionalInfoHTML);*/
						
						var data = new google.visualization.DataTable();
						if (debugMode > 1) console.log("Creating Sankey Diagram DataTable2");
						data.addColumn('string', 'from');
						data.addColumn('string', 'to');
						data.addColumn('number', 'weight');
						
						for (i = 1; i < totalitems; i++)
						{
							childLabel = nodeName[i];
							parentLabel = nodeParentName[i];
							sizeNumber = nodeSize[i];
							if (debugMode > 1) console.log("Item: "+ i + " - " + parentLabel + " " + childLabel + " " + sizeNumber);
							data.addRow([parentLabel, childLabel, sizeNumber]);
						}
						if (debugMode > 1) console.log("dataTable is Ready");

						tree = new google.visualization.Sankey(document.getElementById('map_canvas'));
						if (debugMode > 1) console.log("drawDiagram");

						tree.draw(data, {
										width: portlet_width, height: portlet_height,
										sankey: { 
											node: { 
												interactivity: true,
												label: { fontName: font_family,
													fontSize: font_size,
													color: font_color
													}, 
												labelPadding: label_padding,
												nodePadding: node_padding,
												width: node_width
											},
											iterations: sankey_iterations,
											link: {
												colorMode: 'gradient',
												color:	{
													fill: link_fill_color,
													fillOpacity: link_fill_opacity,
													stroke: link_stroke_color,
													strokeWidth: link_stroke_width
												}
											}
										}
									});

						break;
				}
					
			if(debugMode==1) console.log("OUT: drawMyChart");
				
				return true;
			}
		
	</script>
	</head>
	<body>
		<div id="printerImg" style="position:absolute; top:10px; right:10px">
			<a href="JavaScript:print()">
				<img id="print" src="data:image/png;base64,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" alt="Print">
			</a>
		</div>
		<div id="map_canvas" style="position:absolute; top:10px; right:10px width:96%; height:97%"/>				
	</body>
</html>